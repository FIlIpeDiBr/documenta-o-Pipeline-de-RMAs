<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Documentação Técnica – Pipeline de RMAs</title>
<style>
body {{ font-family: Arial, sans-serif; line-height: 1.6; margin: 20px; }}
h1 {{ color: #0d47a1; }}
h2 {{ color: #1565c0; }}
h3 {{ color: #1e88e5; }}
h4 {{ color: #1976d2; }}
table {{ border-collapse: collapse; width: 100%; margin-top: 10px; }}
th, td {{ border: 1px solid #ccc; padding: 4px 6px; text-align: left; vertical-align: top; }}
th {{ background-color: #f0f0f0; }}
code {{ background-color: #f5f5f5; padding: 2px 4px; border-radius: 3px; }}
img.diagram {{ max-width: 100%; height: auto; margin: 10px 0; border: 1px solid #ccc; }}
</style>
</head>
<body>
<h1>Documentação Técnica – Pipeline de RMAs (v1)</h1>
<p>Esta documentação destina‑se a desenvolvedores, analistas e equipe de TI responsável por manter e evoluir o pipeline de Relatórios de Movimentação de Ativos (RMAs). Aqui são descritos a arquitetura, os componentes internos, o modelo de dados, as funções e integrações externas.</p>
<h2>1. Arquitetura do Sistema</h2>
<p>O pipeline foi implementado em <strong>Google Apps Script</strong> e baseia‑se em scripts acoplados a uma planilha do Google Sheets. Sua arquitetura segue o padrão de separação por camadas e componentes definidos conforme o modelo <em>C4</em>. As principais interações estão resumidas no diagrama de contexto (nível 1) e no diagrama de componentes (nível 2).</p>
<h3>1.1 Diagrama de Contexto</h3>
<p>O diagrama de contexto apresenta uma visão de alto nível das interações entre usuários e sistemas externos. O contador interage com a planilha e o portal, enquanto o pipeline utiliza serviços do Google Drive, Google Docs e a API da OpenAI.</p>
<p><img class="diagram" src="data:image/png;base64,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" alt="Diagrama de contexto" /></p>
<h3>1.2 Diagrama de Componentes</h3>
<p>O diagrama de componentes mostra os principais módulos internos do pipeline e suas dependências. Cada script no projeto Apps Script corresponde a um componente funcional. O <em>Gateway</em> (menu e portal) orquestra a interação do usuário com os demais módulos.</p>
<p><img class="diagram" src="data:image/png;base64,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" alt="Diagrama de componentes" /></p>
<h3>1.3 Navegação C4</h3>
<p>A navegação C4 define quatro níveis de abstração para descrever o sistema. Nesta documentação são utilizados três níveis:</p>
<ol>
<li><strong>Contexto (Nível 1)</strong> – relação entre o sistema e os atores externos, como usuários e serviços (ver diagrama de contexto).</li>
<li><strong>Contêiner/Componentes (Nível 2)</strong> – módulos internos escritos em Apps Script, organizados em arquivos .gs, que executam extração, processamento, geração de relatórios, indicadores e utilidades (ver diagrama de componentes).</li>
<li><strong>Modelo de Dados (Nível 3)</strong> – planilhas e tabelas que formam a base de dados lógica do pipeline (ver diagrama do modelo de dados).</li>
</ol>
<h2>2. Modelo Lógico de Dados</h2>
<p>Os dados são armazenados em abas (sheets) dentro da mesma planilha. As principais abas formam o modelo relacional lógico simplificado a seguir.</p>
<p><img class="diagram" src="data:image/png;base64,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" alt="Modelo de dados" /></p>
<p>A seguir estão descritas as tabelas:</p>
<ul>
<li><strong>Processamento</strong> – armazena metadados dos arquivos importados (ID, nome do arquivo, empresa, mês, ano, tipo, status, mensagem, data de criação e grupo). Cada linha representa um arquivo. Esta aba dirige o fluxo de extração e processamento.</li>
<li><strong>BalancoBase</strong> – estrutura as linhas do balancete extraídas da IA. Colunas: mês, ano, empresa, conta, saldo anterior, débito, crédito, saldo atual.</li>
<li><strong>DreBase</strong> – estrutura as linhas da DRE. Colunas: mês, ano, empresa, conta, valor atual, av (%) atual, valor anterior, av (%) anterior, ah (%).</li>
<li><strong>Indicadores</strong> – consolida indicadores calculados por empresa e período. Inclui colunas fixas (mes, ano, empresa) e colunas dinamicamente geradas pela função de indicadores.</li>
<li><strong>Config</strong> – armazena pares chave/valor com configurações, como IDs de pastas, IDs de modelos e outros parâmetros.</li>
<li><strong>Balanco</strong>, <strong>DRE</strong>, <strong>Integrantes</strong> e <strong>Textos</strong> – utilizados durante a geração de relatórios de grupo (RMA) para montar relatórios personalizados. A aba <em>Balanco</em> e <em>DRE</em> contêm dados consolidados por integrante, <em>Integrantes</em> indica quais empresas farão parte do relatório, e <em>Textos</em> permite adicionar textos pré/entre/pós para cada integrante.</li>
</ul>
<h2>3. Constantes Globais</h2>
<p>O arquivo <code>constants.gs</code> define constantes reutilizadas em diversos módulos. Abaixo estão listados as constantes relevantes:</p>
<table>
<tr><th>Módulo</th><th>Constante</th><th>Valor (literal)</th></tr>
<tr><td>exports.gs</td><td><code>_TABLE_FIELD_MAPS</code></td><td><code>{</code></td></tr>
<tr><td>exports.gs</td><td><code>_portalContext</code></td><td><code>{}</code></td></tr>
<tr><td>constants.gs</td><td><code>MAX_ARQUIVOS_POR_EXECUCAO</code></td><td><code>5</code></td></tr>
<tr><td>constants.gs</td><td><code>SINTETICOS_DRE</code></td><td><code>[</code></td></tr>
<tr><td>constants.gs</td><td><code>SINTETICOS_BALANCO</code></td><td><code>[</code></td></tr>
</table>
<h2>4. Funções e Utilitários</h2>
<p>Esta seção lista todas as funções definidas nos arquivos .gs. Para cada função há uma breve descrição, seus parâmetros e valor de retorno quando documentado.</p>
<table>
<tr><th>Módulo</th><th>Função</th><th>Descrição</th><th>Parâmetros</th><th>Retorno</th></tr>
<tr>
<td>exports.gs</td>
<td><code>getRelatorioModelos</code></td>
<td>Lê a lista de modelos de relatório cadastrados na aba Config. A tabela deve ter um cabeçalho contendo palavras como "nome", "id" e opcionalmente "grupo" para indicar suporte a grupos. Retorna um array de objetos {nome, id, suportaGrupo}. Qualquer linha sem nome ou id é ignorada.</td>
<td></td>
<td><code>Array<Object></code>: Lista de modelos</td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>mostrarSelecaoModelo</code></td>
<td>Exibe um diálogo modal para seleção de um modelo de relatório. O usuário escolhe entre os modelos cadastrados; opcionalmente, o parâmetro isGrupo filtra apenas modelos que suportam agrupamentos. Após a seleção, a callback JS chama a função indicada.</td>
<td><ul><li><code>isGrupo</code> (<em>boolean</em>): Se true, mostra apenas modelos com suportaGrupo</li><li><code>callbackFun</code> (<em>string</em>): Nome da função Apps Script que será invocada com o ID do modelo</li></ul></td>
<td></td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>substituirPlaceholdersSimples</code></td>
<td>Substitui placeholders simples no formato {{chave}} pelos valores fornecidos.</td>
<td><ul><li><code>str</code> (<em>string</em>): Texto a processar</li><li><code>scalars</code> (<em>Object</em>): Valores para substituição</li></ul></td>
<td><code>string</code>: Texto com placeholders substituídos</td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>processarMarcadoresTabela</code></td>
<td>Helper de debug: lista parágrafos e marcações que começam com [[( ou &lt;&lt;( e placeholders {{...}} no corpo do documento. / / Processa marcadores [[(... )]] que precedem uma tabela modelo e os substitui por uma tabela preenchida a partir dos dados de origem.</td>
<td><ul><li><code>docId</code> (<em>string</em>): ID do documento Google Docs a inspecionar</li><li><code>body</code> (<em>GoogleAppsScript.Document.Body</em>): Corpo do documento</li><li><code>dataContext</code> (<em>Object</em>): Dados para preenchimento</li><li><code>scalars</code> (<em>Object</em>): Placeholders {empresa, mes, ano, grupo}</li></ul></td>
<td></td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>exportarRelatorioIndividualDaLinha</code></td>
<td>Ação principal para relatório individual. Mostra a janela de seleção de modelo e, quando o usuário confirma, chama exportarRelatorioIndividualComModelo(modeloId).</td>
<td></td>
<td></td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>exportarRelatorioGrupoDaLinha</code></td>
<td>Ação principal para relatório de grupo. Mostra a janela de seleção de modelo (filtrada para modelos com suporte a grupos) e, ao confirmar, chama exportarRelatorioGrupoComModelo(modeloId).</td>
<td></td>
<td></td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>exportarRelatorioIndividualComModelo</code></td>
<td>Gera um relatório individual usando o modelo especificado. O templateId é passado pela seleção de modelos. A lógica é igual a exportarRmaIndividualDaLinha, porém o ID do template vem do parâmetro.</td>
<td><ul><li><code>templateId</code> (<em>string</em>): ID do template a utilizar</li></ul></td>
<td></td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>exportarRelatorioGrupoComModelo</code></td>
<td>Gera um relatório de grupo usando o modelo especificado. Esta função consolida dados de todas as empresas do grupo e repete blocos do template para cada integrante, adicionando também o consolidado ao final. Usa o modelo informado para qualquer relatório de grupo.</td>
<td><ul><li><code>templateId</code> (<em>string</em>): ID do template selecionado</li></ul></td>
<td></td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>exportarRelatorioIndividualPortal</code></td>
<td>Armazena contexto de relatório selecionado no portal. Usado para persistir seleção de empresa/grupo e período entre a escolha do modelo e a geração do relatório. / var _portalContext = {}; / Ação chamada pelo portal para iniciar geração de relatório individual. Guarda empresa, mês e ano, então chama a seleção de modelo (mostrando apenas modelos individuais). Após a escolha, exportarRelatorioIndividualPortalComModelo é invocado com o templateId.</td>
<td><ul><li><code>empresa</code> (<em>string</em>): Nome da empresa</li><li><code>mes</code> (<em>number|string</em>): Número do mês (1-12)</li><li><code>ano</code> (<em>number|string</em>): Ano numérico</li></ul></td>
<td></td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>exportarRelatorioIndividualPortalComModelo</code></td>
<td>Callback chamado após a seleção de modelo no portal para relatórios individuais. Recupera dados do contexto e gera o relatório.</td>
<td><ul><li><code>templateId</code> (<em>string</em>): ID do modelo selecionado</li></ul></td>
<td></td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>exportarRelatorioIndividualParaEmpresaComModelo</code></td>
<td>Gera um relatório individual para uma empresa específica em um determinado período, usando o modelo selecionado. Esta função não depende da linha selecionada na aba Processamento.</td>
<td><ul><li><code>empresa</code> (<em>string</em>): Nome da empresa</li><li><code>mes</code> (<em>number</em>): Mês (1-12)</li><li><code>ano</code> (<em>number</em>): Ano</li><li><code>templateId</code> (<em>string</em>): ID do template a utilizar</li></ul></td>
<td></td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>exportarRelatorioGrupoPortal</code></td>
<td>Ação chamada pelo portal para iniciar geração de relatório de grupo. Guarda o nome do grupo e o período, então chama a seleção de modelo (apenas modelos compatíveis com grupos). Após a escolha, exportarRelatorioGrupoPortalComModelo é invocado.</td>
<td><ul><li><code>grupo</code> (<em>string</em>): Nome do grupo</li><li><code>mes</code> (<em>number|string</em>): Mês (1-12)</li><li><code>ano</code> (<em>number|string</em>): Ano</li></ul></td>
<td></td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>exportarRelatorioGrupoPortalComModelo</code></td>
<td>Callback chamado após a seleção de modelo no portal para relatórios de grupo. Gera o relatório consolidado de acordo com as flags do modelo.</td>
<td><ul><li><code>templateId</code> (<em>string</em>): ID do modelo selecionado</li></ul></td>
<td></td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>exportarRelatorioGrupoParaGrupoComModelo</code></td>
<td>Gera um relatório consolidado para um grupo específico em um determinado período usando o template selecionado. Esta função não depende da linha selecionada.</td>
<td><ul><li><code>grupo</code> (<em>string</em>): Nome do grupo</li><li><code>mes</code> (<em>number</em>): Mês (1-12)</li><li><code>ano</code> (<em>number</em>): Ano</li><li><code>templateId</code> (<em>string</em>): ID do modelo</li></ul></td>
<td></td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>getEmpresasDisponiveis</code></td>
<td>Retorna a lista de empresas disponíveis na aba Processamento. O cabeçalho é usado para identificar a coluna "Empresa". Resulta em um array de strings sem duplicados.</td>
<td></td>
<td><code>string[]</code>: Lista de empresas</td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>getGruposDisponiveis</code></td>
<td>Retorna a lista de grupos disponíveis na aba Processamento. A coluna "Grupo" é detectada no cabeçalho. Retorna um array sem duplicados.</td>
<td></td>
<td><code>string[]</code>: Lista de grupos</td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>getPeriodosDisponiveisParaEmpresa</code></td>
<td>Retorna a lista de períodos disponíveis (mes/ano) para uma determinada empresa. A aba Processamento é percorrida para encontrar todas as combinações únicas de mês e ano para a empresa informada.</td>
<td><ul><li><code>empresa</code> (<em>string</em>): Nome da empresa</li></ul></td>
<td><code>string[]</code>: Lista de períodos no formato "MM/AAAA"</td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>getPeriodosDisponiveisParaGrupo</code></td>
<td>Retorna a lista de períodos disponíveis (mes/ano) para um determinado grupo. Percorre a aba Processamento para encontrar combinações únicas de mês e ano onde o campo "Grupo" coincide com o valor informado.</td>
<td><ul><li><code>grupo</code> (<em>string</em>): Nome do grupo</li></ul></td>
<td><code>string[]</code>: Lista de períodos no formato "MM/AAAA"</td>
</tr>
<tr>
<td>exports.gs</td>
<td><code>exportarRmaIndividualDaLinha</code></td>
<td>Exporta um relatório de balancete para a linha selecionada na aba Processamento. O template e a pasta de destino são lidos da aba Config (TEMPLATE_BALANCETE_ID e RELATORIOS_FOLDER_ID). O link do documento gerado é salvo na coluna RMA_URL, se existir. / / Exporta um relatório RMA individual para a linha selecionada na aba Processamento. Usa o template definido em TEMPLATE_RMA_INDIVIDUAL_ID e grava o documento na pasta RELATORIOS_FOLDER_ID. O relatório inclui tanto o balancete completo quanto a DRE.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>config.gs</td>
<td><code>getConfigValue</code></td>
<td>Lê um valor da aba "Config" a partir de uma chave. A aba deve ter duas colunas: coluna A com o nome da chave e coluna B com o valor.</td>
<td><ul><li><code>key</code> (<em>string</em>): Chave a procurar na coluna A</li></ul></td>
<td><code>string|null</code>: Valor correspondente ou null se não existir</td>
</tr>
<tr>
<td>config.gs</td>
<td><code>getOpenAiApiKey</code></td>
<td>Recupera a API key da OpenAI armazenada nas propriedades do script. Certifique‑se de definir "OPENAI_API_KEY" nas propriedades do projeto antes de chamar a IA.</td>
<td></td>
<td><code>string|null</code>: A chave da API ou null se não definida</td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>parseFileName</code></td>
<td>Extrai metadados básicos do nome de um arquivo. Aceita nomes no formato EMPRESA_TIPO_aaaa‑mm.ext, onde TIPO pode ser BALANCO ou DRE (variações como “balanço”, “demonstração”, etc. são reconhecidas). Tokens numéricos e palavras comuns são descartados para compor o nome da empresa.</td>
<td><ul><li><code>name</code> (<em>string</em>): Nome completo do arquivo</li></ul></td>
<td><code>{empresa:string, mes:(string|null), ano:(string|null), tipo:string</code>: }</td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>listAllFiles</code></td>
<td>Lista recursivamente todos os arquivos de uma pasta.</td>
<td><ul><li><code>folder</code> (<em>GoogleAppsScript.Drive.Folder</em>): Pasta raiz</li></ul></td>
<td><code>GoogleAppsScript.Drive.File[]</code>: Array de arquivos</td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>getProcessedFileIds</code></td>
<td>Recupera o conjunto de IDs de arquivo já registrados em uma aba “Processamento”, para evitar duplicidades ao escanear a pasta de entrada. Assume que o ID está na primeira coluna da aba.</td>
<td><ul><li><code>procSheet</code> (<em>GoogleAppsScript.Spreadsheet.Sheet</em>): Aba Processamento</li></ul></td>
<td><code>Set<string></code>: Conjunto de IDs de arquivos já registrados</td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>atualizarStatus</code></td>
<td>Atualiza o status e a mensagem de uma determinada linha na aba Processamento. As colunas de status e mensagem são fixas no pipeline: a coluna 7 para o status e a 8 para a mensagem.</td>
<td><ul><li><code>sheet</code> (<em>GoogleAppsScript.Spreadsheet.Sheet</em>): Aba Processamento</li><li><code>rowIndex</code> (<em>number</em>): Índice da linha (1‑based)</li><li><code>status</code> (<em>string</em>): Novo valor de status</li><li><code>mensagem</code> (<em>string</em>): Mensagem opcional</li></ul></td>
<td></td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>converterValor</code></td>
<td>Converte valores numéricos no formato brasileiro para número JavaScript. Aceita strings com separador de milhar (ponto) e separador decimal (vírgula) ou números já em formato nativo.</td>
<td><ul><li><code>val</code> (<em>any</em>): Valor a converter</li></ul></td>
<td><code>number</code>: Valor numérico ou 0 se não for possível converter</td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>sanitizeName</code></td>
<td>Remove acentos, espaços e caracteres não alfanuméricos de um texto. Útil para normalizar nomes de contas ao comparar categorias.</td>
<td><ul><li><code>name</code> (<em>string</em>): Texto de entrada</li></ul></td>
<td><code>string</code>: Texto normalizado</td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>canonicalName</code></td>
<td>Mapeia variações de nomenclatura de contas para uma chave canônica. Isso permite agrupar contas equivalentes, como “ATIVO N CIRCULANTE” e “ATIVO NÃO CIRCULANTE”, sob a mesma identificação.</td>
<td><ul><li><code>name</code> (<em>string</em>): Nome original da conta</li></ul></td>
<td><code>string</code>: Nome canônico</td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>inferTipoFromConteudo</code></td>
<td>Tenta inferir se o texto extraído de um documento é de balancete (balanco) ou de DRE. Utiliza heurísticas simples baseadas em palavras‑chave típicas de cada tipo.</td>
<td><ul><li><code>text</code> (<em>string</em>): Conteúdo do documento</li></ul></td>
<td><code>string</code>: 'BALANCO' ou 'DRE'</td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>extrairEmpresaMesAnoDoTexto</code></td>
<td>Extrai heuristicamente o nome da empresa, o mês e o ano a partir de texto de relatório contábil. Caso a IA falhe na extração estruturada, esta função usa expressões regulares e padrões simples como “Empresa:”, datas no formato dd/mm/aaaa e outros indicativos para tentar obter essas informações.</td>
<td><ul><li><code>text</code> (<em>string</em>): Texto completo do documento</li></ul></td>
<td><code>{empresa:(string|null), mes:(string|null), ano:(string|null)</code>: }</td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>getMonthName</code></td>
<td>Traduz um número de mês (1–12) no nome correspondente em português. Caso o número esteja fora do intervalo, retorna o próprio valor.</td>
<td><ul><li><code>mes</code> (<em>string|number</em>): Número do mês</li></ul></td>
<td><code>string</code>: Nome do mês ou o valor original</td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>getSinteticosBalanco</code></td>
<td>Devolve a lista de categorias sintéticas de balancete. Usa a constante SINTETICOS_BALANCO definida em `constants.gs`.</td>
<td></td>
<td><code>string[]</code>: </td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>getSinteticosDre</code></td>
<td>Devolve a lista de categorias sintéticas de DRE. Usa a constante SINTETICOS_DRE definida em `constants.gs`.</td>
<td></td>
<td><code>string[]</code>: </td>
</tr>
<tr>
<td>utils.gs</td>
<td><code>obterLinhaSelecionadaProcessamento</code></td>
<td>Lê a linha atualmente selecionada na aba "Processamento" e devolve os valores de suas colunas em um objeto. Se a seleção estiver fora da aba ou for a linha de cabeçalho, uma mensagem de alerta é exibida e null é retornado.</td>
<td></td>
<td><code>Object|null</code>: Objeto com os dados da linha selecionada ou null</td>
</tr>
<tr>
<td>extraction.gs</td>
<td><code>scanEntrada</code></td>
<td>Escaneia a pasta configurada em ENTRADA_FOLDER_ID e registra novos arquivos na aba "Processamento". Cada arquivo recebe metadados básicos extraídos do nome (empresa, mês, ano, tipo) e status "PENDENTE_EXTRAÇÃO".</td>
<td></td>
<td></td>
</tr>
<tr>
<td>extraction.gs</td>
<td><code>extrairTextoDoArquivo</code></td>
<td>Converte um arquivo PDF ou Excel para texto. Para PDFs, utiliza a conversão para Google Docs (via Advanced Drive Service) e lê o conteúdo com DocumentApp. Para arquivos Excel, exporta para CSV. Outros formatos retornam o conteúdo do blob como string.</td>
<td><ul><li><code>fileId</code> (<em>string</em>): ID do arquivo no Drive</li></ul></td>
<td><code>string</code>: Texto extraído</td>
</tr>
<tr>
<td>extraction.gs</td>
<td><code>extrairConteudoArquivosPendentes</code></td>
<td>Processa linhas pendentes na aba "Processamento": extrai o texto bruto, determina o tipo do documento, envia à IA e salva o resultado na base. Atualiza o status conforme o progresso. O processamento é limitado por MAX_ARQUIVOS_POR_EXECUCAO para evitar exceder o tempo máximo de execução do Apps Script.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>extraction.gs</td>
<td><code>extrairConteudoNaoProcessado</code></td>
<td>Reprocessa todas as linhas da aba "Processamento" cujo status não seja "PROCESSADO". Útil para reexecutar erros anteriores ou registros parcialmente processados. A lógica é idêntica à de extrairConteudoArquivosPendentes, mas considera qualquer status diferente de PROCESSADO como apto para reprocessar.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>processing.gs</td>
<td><code>salvarLinhasBalanco</code></td>
<td>Insere as linhas extraídas de um balancete na aba BalancoBase. A aba possui as colunas: mes, ano, empresa, conta, saldo anterior, débito, crédito e saldo atual. Novas linhas são anexadas ao final.</td>
<td><ul><li><code>meta</code> (<em>Object</em>): Metadados {empresa, mes, ano}</li><li><code>linhas</code> (<em>Array<Object></em>): Lista de objetos com os campos de conta e valores</li></ul></td>
<td></td>
</tr>
<tr>
<td>processing.gs</td>
<td><code>salvarLinhasDre</code></td>
<td>Insere as linhas extraídas de uma DRE na aba DreBase. A aba possui as colunas: mes, ano, empresa, conta, valor atual, av atual (%), valor anterior, av anterior (%) e ah (%). Novas linhas são anexadas ao final.</td>
<td><ul><li><code>meta</code> (<em>Object</em>): Metadados {empresa, mes, ano}</li><li><code>linhas</code> (<em>Array<Object></em>): Lista de objetos com os campos de conta e valores</li></ul></td>
<td></td>
</tr>
<tr>
<td>processing.gs</td>
<td><code>processarConteudo</code></td>
<td>Processa o texto bruto extraído de um arquivo de balancete ou DRE. Envia o texto à IA, interpreta o JSON resultante e grava nas respectivas abas base. Caso o tipo não esteja claro, tenta inferi‑lo a partir do conteúdo. As categorias sintéticas são garantidas mesmo se a IA não as devolver.</td>
<td><ul><li><code>tipo</code> (<em>string</em>): Tipo indicado pelo nome do arquivo (BALANCO/DRE)</li><li><code>meta</code> (<em>Object</em>): Metadados do arquivo (empresa, mes, ano, grupo)</li><li><code>conteudo</code> (<em>string</em>): Texto extraído do arquivo</li></ul></td>
<td></td>
</tr>
<tr>
<td>processing.gs</td>
<td><code>buildPromptBalanco</code></td>
<td>Monta o prompt para extração de balancetes. Mantido como função separada para manter `processarConteudo` mais legível.</td>
<td><ul><li><code>conteudo</code> (<em>string</em>): Texto completo do balancete</li></ul></td>
<td><code>string</code>: Prompt a ser enviado à IA</td>
</tr>
<tr>
<td>processing.gs</td>
<td><code>buildPromptDre</code></td>
<td>Monta o prompt para extração de DREs.</td>
<td><ul><li><code>conteudo</code> (<em>string</em>): Texto completo da DRE</li></ul></td>
<td><code>string</code>: Prompt a ser enviado à IA</td>
</tr>
<tr>
<td>dashboard.gs</td>
<td><code>abrirPainelIndicadores</code></td>
<td>Abre a barra lateral com o painel de indicadores. O HTML é carregado do arquivo IndicadoresSidebar (não incluído neste refactoring), que deve existir no projeto. A barra lateral permite visualizar gráficos e tabelas a partir da aba "Indicadores".</td>
<td></td>
<td></td>
</tr>
<tr>
<td>dashboard.gs</td>
<td><code>getIndicadoresData</code></td>
<td>Retorna os dados presentes na aba "Indicadores" para consumo pela interface HTML. O retorno contém um array de nomes de indicadores (colunas) e um array de objetos, cada um com as propriedades mes, ano, empresa e um objeto values com as demais métricas.</td>
<td></td>
<td><code>{indicators: string[], rows: Array<Object></code>: }</td>
</tr>
<tr>
<td>dashboard.gs</td>
<td><code>doGet</code></td>
<td>Manipulador para requisições GET quando o script é implantado como web app. Usa o mesmo HTML da sidebar para renderizar o painel em tela cheia. O modo de XFrameOptions é liberado para permitir embed em iframes se necessário. / / function doGet(e) { return HtmlService .createTemplateFromFile('IndicadoresSidebar') .evaluate() .setTitle('Painel de Indicadores') .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL); }</td>
<td><ul><li><code>e</code> (<em>Object</em>): Objeto de evento (não utilizado)</li></ul></td>
<td><code>HtmlOutput</code>: </td>
</tr>
<tr>
<td>dashboard.gs</td>
<td><code>getWebAppUrl</code></td>
<td>Retorna a URL de execução do web app. Se o script estiver implantado como web app, ScriptApp.getService().getUrl() retorna a URL pública; caso contrário, pode ser necessário substituir por uma constante. Esta função é disponibilizada ao HTML.</td>
<td></td>
<td><code>string</code>: URL do web app</td>
</tr>
<tr>
<td>data_loaders.gs</td>
<td><code>carregarBalancoEmpresaPeriodo</code></td>
<td>Lê a aba BalancoBase e retorna as linhas do balancete para uma determinada empresa e período. As contas sintéticas definidas em SINTETICOS_BALANCO são separadas das demais.</td>
<td><ul><li><code>empresa</code> (<em>string</em>): Nome da empresa</li><li><code>mes</code> (<em>string|number</em>): Mês de competência (numérico ou string)</li><li><code>ano</code> (<em>string|number</em>): Ano de competência</li></ul></td>
<td><code>{detalhados: Array<Object>, sinteticos: Array<Object></code>: }</td>
</tr>
<tr>
<td>data_loaders.gs</td>
<td><code>carregarDreEmpresaPeriodo</code></td>
<td>Lê a aba DreBase e retorna as linhas da DRE para uma empresa e período específicos. A DRE não possui separação entre contas sintéticas e detalhadas neste contexto; todas as linhas são retornadas em um único array.</td>
<td><ul><li><code>empresa</code> (<em>string</em>): Nome da empresa</li><li><code>mes</code> (<em>string|number</em>): Mês de competência</li><li><code>ano</code> (<em>string|number</em>): Ano de competência</li></ul></td>
<td><code>Array<Object></code>: Lista de linhas da DRE</td>
</tr>
<tr>
<td>period_preparation.gs</td>
<td><code>prepararPeriodo</code></td>
<td>Prepara as abas de trabalho (Balanco, DRE, Integrantes, Textos) a partir das bases multi‑período para uma empresa e período selecionados. Isto permite reutilizar a função generateRmaFromSheets para gerar o relatório RMA completo. A função limpa as abas de trabalho, escreve metadados e preenche as linhas correspondentes.</td>
<td><ul><li><code>empresa</code> (<em>string</em>): Nome da empresa</li><li><code>mes</code> (<em>string</em>): Mês (duas casas)</li><li><code>ano</code> (<em>string</em>): Ano (quatro casas)</li></ul></td>
<td></td>
</tr>
<tr>
<td>openai_service.gs</td>
<td><code>chamarOpenAiComMensagens</code></td>
<td>Envia um array de mensagens para a API da OpenAI e retorna o JSON resultado. Se ocorrer erro, uma exceção é lançada com a mensagem retornada pela API. O modelo e a temperatura são configuráveis através dos argumentos, com valores padrão definidos para uso geral.</td>
<td><ul><li><code>messages</code> (<em>Array<Object></em>): Mensagens de chat conforme API</li></ul></td>
<td><code>Object</code>: Resposta JSON da OpenAI</td>
</tr>
<tr>
<td>openai_service.gs</td>
<td><code>chamarOpenAi</code></td>
<td>Mantém compatibilidade com código legado, aceitando um prompt como string e montando as mensagens necessárias para o endpoint de chat. O prompt será enviado como mensagem de usuário após um contexto inicial de especialista contábil.</td>
<td><ul><li><code>prompt</code> (<em>string</em>): Texto a enviar à IA</li></ul></td>
<td><code>Object</code>: JSON retornado pela OpenAI</td>
</tr>
<tr>
<td>indicators.gs</td>
<td><code>calcularPercentuaisDre</code></td>
<td>Recalcula as colunas "av atual (%)", "av anterior (%)" e "ah (%)" na aba DreBase. A análise vertical utiliza as somas de cada categoria dentro de (empresa, mes, ano); a análise horizontal compara valores atuais e anteriores. O resultado é gravado na própria aba.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>indicators.gs</td>
<td><code>getIndicadoresSheet</code></td>
<td>Garante a existência da aba "Indicadores" e retorna seu objeto Sheet. A primeira linha contém o cabeçalho padrão com todos os indicadores suportados. Se a aba não existir, ela é criada.</td>
<td></td>
<td><code>GoogleAppsScript.Spreadsheet.Sheet</code>: A aba de indicadores</td>
</tr>
<tr>
<td>indicators.gs</td>
<td><code>gerarIndicadoresComDados</code></td>
<td>Gera ou atualiza indicadores para uma empresa e período específicos. Se já existir uma linha para (mes, ano, empresa) na aba Indicadores, ela é sobrescrita; caso contrário, uma nova linha é acrescentada. Os dados de balancete e DRE são fornecidos como parâmetros, permitindo reuso tanto para empresas quanto para grupos.</td>
<td><ul><li><code>identificador</code> (<em>string</em>): Nome da entidade (empresa ou "[GRUPO] X")</li><li><code>mes</code> (<em>string|number</em>): Mês de competência</li><li><code>ano</code> (<em>string|number</em>): Ano de competência</li><li><code>dreData</code> (<em>Array<Object></em>): Linhas da DRE do período</li><li><code>balSintetico</code> (<em>Array<Object></em>): Linhas sintéticas do balancete</li><li><code>quiet</code> (<em>boolean</em>): Se true, não exibe alertas; se false, mostra mensagens de erro</li></ul></td>
<td><code>boolean</code>: True se indicadores foram gravados com sucesso</td>
</tr>
<tr>
<td>indicators.gs</td>
<td><code>gerarIndicadoresParaEmpresaPeriodo</code></td>
<td>Gera indicadores para uma empresa e período a partir das bases BalancoBase e DreBase. Internamente carrega as linhas do balancete (sintéticas) e da DRE e chama gerarIndicadoresComDados.</td>
<td><ul><li><code>empresa</code> (<em>string</em>): Nome da empresa</li><li><code>mes</code> (<em>string|number</em>): Mês</li><li><code>ano</code> (<em>string|number</em>): Ano</li><li><code>quiet</code> (<em>boolean</em>): Se true, silencia mensagens de alerta</li></ul></td>
<td><code>boolean</code>: True se os indicadores foram gerados</td>
</tr>
<tr>
<td>indicators.gs</td>
<td><code>gerarIndicadoresDaLinha</code></td>
<td>Gera indicadores para a linha selecionada na aba "Processamento". A função lê os metadados da linha (empresa, mes, ano) e invoca gerarIndicadoresParaEmpresaPeriodo. Exibe mensagem ao final.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>indicators.gs</td>
<td><code>gerarIndicadoresPendentes</code></td>
<td>Gera indicadores em lote para todas as empresas na aba Processamento com status "PROCESSADO" que ainda não possuem indicadores gerados. O número de execuções é limitado por MAX_ARQUIVOS_POR_EXECUCAO (ou 5 se não definido) para não extrapolar o tempo de execução do Apps Script.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>indicators.gs</td>
<td><code>gerarIndicadoresParaGrupoPeriodo</code></td>
<td>Consolida dados de balancete e DRE para as empresas de um grupo e gera indicadores para o período informado. O identificador na aba Indicadores é prefixado com "[GRUPO] ".</td>
<td><ul><li><code>grupo</code> (<em>string</em>): Nome do grupo</li><li><code>mes</code> (<em>string|number</em>): Mês</li><li><code>ano</code> (<em>string|number</em>): Ano</li><li><code>quiet</code> (<em>boolean</em>): Se true, suprime alertas</li></ul></td>
<td><code>boolean</code>: True se os indicadores foram gerados</td>
</tr>
<tr>
<td>indicators.gs</td>
<td><code>gerarIndicadoresGruposPendentes</code></td>
<td>Gera indicadores em lote para todos os grupos presentes na aba Processamento com status PROCESSADO que ainda não foram cadastrados na aba Indicadores. Utiliza o mesmo limite de execuções de gerarIndicadoresPendentes.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>indicators.gs</td>
<td><code>gerarIndicadoresGrupoDaLinha</code></td>
<td>Gera indicadores para o grupo da linha atualmente selecionada na aba Processamento. Se a linha não possui um grupo definido, exibe mensagem de alerta. Caso contrário, delega para gerarIndicadoresParaGrupoPeriodo.</td>
<td></td>
<td></td>
</tr>
<tr>
<td>rma_generator.gs</td>
<td><code>styleTable</code></td>
<td>Aplica formatação a uma tabela do Google Docs. O cabeçalho fica negrito com fundo azul claro e as linhas alternam entre cores diferentes para melhorar a legibilidade.</td>
<td><ul><li><code>table</code> (<em>GoogleAppsScript.Document.Table</em>): Tabela a formatar</li></ul></td>
<td></td>
</tr>
<tr>
<td>rma_generator.gs</td>
<td><code>computeConsolidated</code></td>
<td>Consolida valores do balancete e da DRE a partir das abas individuais. Retorna listas contendo valores para cada categoria, bem como percentuais de análise vertical e horizontal. Esses resultados são usados para preencher o consolidado do relatório.</td>
<td><ul><li><code>balValues</code> (<em>Object[][]</em>): Linhas da aba Balanco</li><li><code>dreValues</code> (<em>Object[][]</em>): Linhas da aba DRE</li></ul></td>
<td><code>Object</code>: Estrutura com dados consolidados</td>
</tr>
<tr>
<td>rma_generator.gs</td>
<td><code>substituirTagPorTabelaNoBody</code></td>
<td>Substitui uma marca de tabela ({{nomeTag}}) por uma tabela no corpo do documento. Se o parágrafo contém apenas a tag, ele é substituído pela tabela; se a tag está misturada com texto, a tabela é inserida abaixo e a tag é removida do texto.</td>
<td><ul><li><code>body</code> (<em>GoogleAppsScript.Document.Body</em>): Corpo do documento</li><li><code>tag</code> (<em>string</em>): Nome da tag a substituir</li><li><code>headers</code> (<em>string[]</em>): Cabeçalho da tabela</li><li><code>rows</code> (<em>Array[]</em>): Linhas da tabela</li></ul></td>
<td></td>
</tr>
<tr>
<td>rma_generator.gs</td>
<td><code>generateRmaFromSheets</code></td>
<td>Gera o relatório RMA a partir das abas Balanco, DRE, Integrantes e Textos. Cria uma cópia do template definido em TEMPLATE_RMA_ID e preenche com os dados de cada integrante, incluindo um consolidado. Retorna a URL do documento gerado.</td>
<td></td>
<td><code>string</code>: URL do documento criado</td>
</tr>
<tr>
<td>group_reports.gs</td>
<td><code>getEmpresaColIndex_</code></td>
<td>Obtém o índice da coluna "empresa" na aba Processamento. Se não existir, retorna o índice da coluna 3, que é o local padrão.</td>
<td><ul><li><code>procSheet</code> (<em>GoogleAppsScript.Spreadsheet.Sheet</em>): Aba Processamento</li></ul></td>
<td><code>number</code>: Índice da coluna (1‑based)</td>
</tr>
<tr>
<td>group_reports.gs</td>
<td><code>ensureGrupoColumn_</code></td>
<td>Garante a existência de uma coluna "Grupo" na aba Processamento e devolve seu índice. Se a coluna não existir, ela é criada ao final da linha de cabeçalho.</td>
<td><ul><li><code>procSheet</code> (<em>GoogleAppsScript.Spreadsheet.Sheet</em>): Aba Processamento</li></ul></td>
<td><code>number</code>: Índice da coluna (1‑based)</td>
</tr>
<tr>
<td>group_reports.gs</td>
<td><code>gerenciarGrupos</code></td>
<td>Abre um diálogo para gerenciar os grupos das empresas. Lista todas as empresas encontradas na aba Processamento com seus grupos atuais e permite edição em um formulário HTML. O salvamento é feito pela função salvarGrupos().</td>
<td></td>
<td></td>
</tr>
<tr>
<td>group_reports.gs</td>
<td><code>listarEmpresasGrupos</code></td>
<td>Retorna a lista de empresas com seus respectivos grupos para uso no portal.</td>
<td></td>
<td><code>Array<{empresa:string, grupo:string</code>: &gt;}</td>
</tr>
<tr>
<td>group_reports.gs</td>
<td><code>salvarGrupos</code></td>
<td>Recebe o mapa empresa-&gt;grupo vindo do diálogo e grava na aba Processamento, atualizando todas as linhas da empresa.</td>
<td><ul><li><code>grupos</code> (<em>Object</em>): Mapa de empresas para grupos</li></ul></td>
<td></td>
</tr>
<tr>
<td>group_reports.gs</td>
<td><code>obterEmpresasDoGrupoNoPeriodo</code></td>
<td>Retorna a lista de empresas de um grupo em um determinado período (mes/ano) a partir da aba Processamento. A lista é ordenada alfabeticamente.</td>
<td><ul><li><code>grupo</code> (<em>string</em>): Nome do grupo</li><li><code>mes</code> (<em>string|number</em>): Mês</li><li><code>ano</code> (<em>string|number</em>): Ano</li></ul></td>
<td><code>string[]</code>: Empresas participantes</td>
</tr>
<tr>
<td>group_reports.gs</td>
<td><code>montarDadosGrupo</code></td>
<td>Consolida dados de balancete e DRE para cada empresa de um grupo e constrói também um consolidado geral. Retorna um objeto com a lista de integrantes e o consolidado.</td>
<td><ul><li><code>grupo</code> (<em>string</em>): Nome do grupo</li><li><code>mes</code> (<em>string|number</em>): Mês</li><li><code>ano</code> (<em>string|number</em>): Ano</li><li><code>empresas</code> (<em>string[]</em>): Lista de empresas do grupo</li></ul></td>
<td><code>{integrantes:Array, consolidado:Object</code>: }</td>
</tr>
<tr>
<td>group_reports.gs</td>
<td><code>preencherBlocoGrupo</code></td>
<td>Preenche um bloco de elementos do corpo do documento com dados de um integrante. Substitui tags {{empresa}}, {{mes}}, {{ano}}, {{grupo}} e insere tabelas de balancete e DRE do integrante.</td>
<td><ul><li><code>body</code> (<em>GoogleAppsScript.Document.Body</em>): Corpo do documento</li><li><code>startIdx</code> (<em>number</em>): Índice inicial do bloco</li><li><code>endIdx</code> (<em>number</em>): Índice final do bloco</li><li><code>intg</code> (<em>Object</em>): Objeto do integrante (ou consolidado)</li><li><code>monthName</code> (<em>string</em>): Nome do mês</li><li><code>ano</code> (<em>string</em>): Ano</li><li><code>grupo</code> (<em>string</em>): Nome do grupo</li></ul></td>
<td></td>
</tr>
<tr>
<td>group_reports.gs</td>
<td><code>replicarBlocoGrupo</code></td>
<td>Replica o bloco delimitado por [[[ e ]]] no documento para cada integrante do grupo (incluindo o consolidado). Cada bloco gerado é preenchido com os dados do respectivo integrante. / / Replica o bloco delimitado por &lt;&lt;(...)&gt;&gt; no documento para cada integrante do grupo e opcionalmente para o consolidado. O texto entre parênteses no marcador de início define flags separadas por vírgulas. A flag "consolidar" inclui o consolidado ao final. Sem essa flag, o consolidado não é gerado.</td>
<td><ul><li><code>body</code> (<em>GoogleAppsScript.Document.Body</em>): Corpo do documento</li><li><code>dadosGrupo</code> (<em>Object</em>): Objeto retornado por montarDadosGrupo</li><li><code>monthName</code> (<em>string</em>): Nome do mês</li><li><code>ano</code> (<em>string|number</em>): Ano</li><li><code>grupo</code> (<em>string</em>): Nome do grupo</li><li><code>body</code> (<em>GoogleAppsScript.Document.Body</em>): Corpo do documento</li><li><code>dadosGrupo</code> (<em>Object</em>): Objeto retornado por montarDadosGrupo</li><li><code>monthName</code> (<em>string</em>): Nome do mês</li><li><code>ano</code> (<em>string|number</em>): Ano</li><li><code>grupo</code> (<em>string</em>): Nome do grupo</li></ul></td>
<td></td>
</tr>
<tr>
<td>group_reports.gs</td>
<td><code>exportarRmaGrupoDaLinha</code></td>
<td>Exporta um relatório RMA de grupo para a linha selecionada na aba Processamento. Consolida dados das empresas do mesmo grupo no período selecionado, replica o bloco de template para cada integrante e grava o documento em RELATORIOS_FOLDER_ID.</td>
<td></td>
<td></td>
</tr>
</table>
<h2>5. Integração com APIs e Serviços Externos</h2>
<p>O pipeline interage com vários serviços externos:</p>
<ul>
<li><strong>Google Drive</strong> – utilizado para ler arquivos de entrada (pastas configuradas com <code>ENTRADA_FOLDER_ID</code>), mover arquivos processados e armazenar os documentos gerados (relatórios). Também é usado para criar arquivos temporários ao converter PDFs em Google Docs para extração de texto.</li>
<li><strong>Google Docs</strong> – usado para criar relatórios a partir de templates. O módulo <code>rma_generator.gs</code> copia um documento modelo (configurado em <code>TEMPLATE_RMA_ID</code>), substitui marcadores de texto, insere tabelas e aplica formatação.</li>
<li><strong>Google Sheets</strong> – a própria planilha é o repositório de dados e interface principal. Scripts acessam as abas através da API do Apps Script (<code>SpreadsheetApp</code>) para ler e escrever dados.</li>
<li><strong>OpenAI API</strong> – a função <code>chamarOpenAi</code> envia prompts de balancete ou DRE para o endpoint de chat completions da OpenAI, obtendo JSON estruturado com metadados e linhas de contas. É preciso definir a chave de API (<code>OPENAI_API_KEY</code>) nas propriedades do script.</li>
<li><strong>Drive Advanced Service</strong> – opcionalmente habilitado para converter PDFs em Google Docs (via <code>Drive.Files.copy</code>) e ler seu conteúdo com <code>DocumentApp</code>. Caso não habilitado, a conversão de PDFs não funcionará.</li>
</ul>
<h2>6. Observações de Implementação</h2>
<ul>
<li>A maioria das funções utiliza APIs do Google Apps Script, que podem lançar exceções caso permissões ou serviços não estejam habilitados. O código verifica pré‑condições simples (existência de aba, ID configurado) e exibe alertas ao usuário.</li>
<li>Para evitar exceder o tempo de execução (6 minutos), o processamento de arquivos é limitado pela constante <code>MAX_ARQUIVOS_POR_EXECUCAO</code>. Execuções podem ser repetidas para processar mais arquivos.</li>
<li>A classificação de contas em categorias sintéticas é baseada nas constantes <code>SINTETICOS_BALANCO</code> e <code>SINTETICOS_DRE</code>. Esses nomes devem coincidir com aqueles retornados pela IA.</li>
<li>A geração de relatórios de grupo utiliza a aba <em>Integrantes</em> para listar empresas e períodos e a aba <em>Textos</em> para personalizar comentários. O consolidado é calculado automaticamente.</li>
<li>O portal HTML (<code>index.html</code>) e o painel de indicadores (<code>IndicadoresSidebar.html</code>) usam <code>google.script.run</code> para chamar funções do back‑end, fornecendo uma interface mais amigável.</li>
</ul>
<p>Esta documentação técnica descreve a versão inicial do pipeline e deve ser mantida atualizada conforme novas funcionalidades forem adicionadas.</p>
</body>
</html>