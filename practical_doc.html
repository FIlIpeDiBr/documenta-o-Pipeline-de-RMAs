<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Guia Prático do Pipeline de RMAs</title>
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
/* Estilos personalizados para melhor legibilidade */
body {
    font-family: Arial, sans-serif;
    background-color: #f8f9fa;
    padding-top: 70px;
}
.navbar-brand {
    font-weight: bold;
}
.section {
    padding-top: 2rem;
    padding-bottom: 2rem;
}
.section h2 {
    color: #0d47a1;
    margin-bottom: 1rem;
}
.step-card {
    border: 1px solid #ddd;
    border-radius: 0.5rem;
    padding: 1rem;
    background-color: #fff;
    margin-bottom: 1rem;
}
.table th {
    background-color: #e3f2fd;
}
</style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
<div class="container-fluid">
    <a class="navbar-brand" href="#">Pipeline de RMAs</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
            <li class="nav-item"><a class="nav-link" href="#visao">Visão Geral</a></li>
            <li class="nav-item"><a class="nav-link" href="#pre">Antes de Começar</a></li>
            <li class="nav-item"><a class="nav-link" href="#fluxo">Fluxo de Trabalho</a></li>
            <li class="nav-item"><a class="nav-link" href="#portal">Uso do Portal</a></li>
            <li class="nav-item"><a class="nav-link" href="#modelos">Modelos &amp; Tags</a></li>
            <li class="nav-item"><a class="nav-link" href="#faq">Dicas &amp; FAQ</a></li>
        </ul>
    </div>
</div>
</nav>

<div class="container">
    <section id="visao" class="section">
        <h2>Visão Geral</h2>
        <p>Este guia foi escrito para contadores e operadores que precisam gerar Relatórios de Movimentação de Ativos (RMAs) sem dominar aspectos técnicos do código. Aqui você encontra uma explicação direta sobre <strong>o que fazer, como fazer e por que cada passo é importante</strong>. O Pipeline de RMAs automatiza a extração de dados de balancetes e DREs, calcula indicadores e cria relatórios prontos para apresentação.</p>
        <p>Você trabalhará basicamente com dois pontos de acesso: uma planilha do Google (com menu personalizado) e um portal web integrado. Cada um tem seus papéis – a planilha guarda dados e modelos, enquanto o portal simplifica as ações de rotina.</p>
    </section>

    <section id="pre" class="section">
        <h2>Antes de Começar</h2>
        <p>Antes de processar qualquer documento, confira se os requisitos abaixo estão atendidos:</p>
        <ul>
            <li>Utilize uma conta Google que tenha acesso ao <em>Google Sheets</em>, <em>Google Docs</em> e <em>Google Drive</em>.</li>
            <li>Abra a planilha <strong>RMA Pipeline</strong>. Ao carregá-la, aparecerá um menu chamado <strong>RMA Pipeline</strong> com opções como “Processar Entrada” e “Gerar Relatórios”.</li>
            <li>Na aba <em>Config</em> da planilha, informe as <strong>pastas do Drive</strong> onde serão depositados os PDFs/Excel de balancetes (entrada), onde deseja salvar os arquivos processados e os modelos de documentos do Google Docs que servirão de base para os relatórios.</li>
            <li>Verifique se existe pelo menos um <strong>modelo de relatório</strong> cadastrado. Sem modelos o sistema não consegue gerar RMAs.</li>
        </ul>
        <p>Com esses itens prontos, você está apto a iniciar o fluxo de trabalho.</p>
    </section>

    <section id="fluxo" class="section">
        <h2>Fluxo de Trabalho</h2>
        <p>A figura abaixo resume o processo completo. Mais abaixo detalhamos cada etapa.</p>
        <div class="text-center mb-4">
            <img src="infographic_small.jpg" alt="Fluxo de RMAs" class="img-fluid" style="max-width:800px;">
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="step-card">
                    <h5>1. Envio de Documentos</h5>
                    <p>Coloque os PDFs ou planilhas (balancetes e DRE) na pasta de entrada configurada. Isso aciona o primeiro passo do pipeline. Quanto mais organizado for o envio (nomes claros, uma empresa por arquivo), mais rápido e preciso será o processamento.</p>
                </div>
                <div class="step-card">
                    <h5>2. Processamento de Dados</h5>
                    <p>No portal, clique em <strong>Processar Entrada</strong>. O sistema lerá os documentos na pasta de entrada, identificará cada empresa e período e extrairá as informações necessárias. O pipeline usa inteligência artificial para compreender textos e estruturar tabelas. Quando terminar, os arquivos serão movidos (opcionalmente) para a pasta “processados”.</p>
                </div>
                <div class="step-card">
                    <h5>3. Cálculo de Indicadores</h5>
                    <p>Na aba <em>Indicadores</em> da planilha ou na seção correspondente do portal, o sistema calcula percentuais de análise vertical, horizontal e outros índices (liquidez, endividamento, rentabilidade) para as empresas processadas. Esses indicadores ajudam a interpretar os números além dos valores absolutos.</p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="step-card">
                    <h5>4. Geração de Relatórios</h5>
                    <p>Com os dados e indicadores prontos, escolha <strong>Gerar Relatórios</strong> no portal. Você seleciona o modelo desejado e, se for o caso, um grupo de empresas para consolidação. O sistema substitui as tags do modelo pelos valores corretos, cria tabelas e formatações e salva os documentos no Drive. Em segundos você terá um RMA completo e apresentável.</p>
                </div>
                <div class="step-card">
                    <h5>5. Resultados</h5>
                    <p>Os relatórios gerados ficarão na pasta de destino configurada no início. Além disso, as abas da planilha permanecerão atualizadas com os dados extraídos, permitindo consultas e análises futuras. Utilize a seção de indicadores no portal para comparar empresas e períodos rapidamente.</p>
                </div>
            </div>
        </div>
    </section>

    <section id="portal" class="section">
        <h2>Uso do Portal</h2>
        <p>O portal web foi projetado para tornar as operações do dia a dia mais simples e intuitivas. Para acessá-lo, abra a planilha e escolha <strong>RMA Pipeline → Abrir Portal</strong>. Ele será exibido em uma nova aba do navegador.</p>
        <h3>Ações Principais</h3>
        <div class="accordion" id="portalAccordion">
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingProcessar">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseProcessar" aria-expanded="true" aria-controls="collapseProcessar">
                        Processar Entrada
                    </button>
                </h2>
                <div id="collapseProcessar" class="accordion-collapse collapse show" aria-labelledby="headingProcessar" data-bs-parent="#portalAccordion">
                    <div class="accordion-body">
                        <p>Esta função lê todos os arquivos na pasta de entrada. Você verá uma lista de documentos encontrados; confirme e inicie o processamento. O sistema extrai cada balancete e DRE, transforma em tabelas e preenche as abas <em>BalancoBase</em> e <em>DreBase</em> da planilha.</p>
                        <p><strong>Por que fazer?</strong> Sem este passo não há dados para os indicadores nem para o relatório final. É aqui que a mágica acontece.</p>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingRelat">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRelat" aria-expanded="false" aria-controls="collapseRelat">
                        Gerar Relatórios
                    </button>
                </h2>
                <div id="collapseRelat" class="accordion-collapse collapse" aria-labelledby="headingRelat" data-bs-parent="#portalAccordion">
                    <div class="accordion-body">
                        <p>Aqui você seleciona um modelo cadastrado e, opcionalmente, um grupo de empresas. Clique em “Gerar” e aguarde a criação dos documentos. O portal mostrará links para cada RMA gerado.</p>
                        <p><strong>Por que fazer?</strong> O relatório é o produto final. Automatizando a montagem você ganha tempo e consistência, evitando erros de cópia/cola.</p>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingIndic">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseIndic" aria-expanded="false" aria-controls="collapseIndic">
                        Indicadores
                    </button>
                </h2>
                <div id="collapseIndic" class="accordion-collapse collapse" aria-labelledby="headingIndic" data-bs-parent="#portalAccordion">
                    <div class="accordion-body">
                        <p>Visualize rapidamente gráficos e tabelas comparando empresas e períodos. Você pode filtrar por empresa, indicador e intervalo. Utilize esses insights para embasar decisões e apresentar análises mais ricas aos clientes.</p>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingGrupos">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseGrupos" aria-expanded="false" aria-controls="collapseGrupos">
                        Grupos e Consolidação
                    </button>
                </h2>
                <div id="collapseGrupos" class="accordion-collapse collapse" aria-labelledby="headingGrupos" data-bs-parent="#portalAccordion">
                    <div class="accordion-body">
                        <p>Você pode agrupar empresas (por exemplo, todas as unidades de uma rede) para gerar um relatório consolidado. No portal, use a opção <em>Gerenciar Grupos</em> para criar, editar ou excluir grupos. Depois, escolha o grupo na hora de gerar o relatório.</p>
                        <p><strong>Por que fazer?</strong> Consolidar dados permite enxergar o desempenho coletivo de várias entidades, útil para holdings ou estruturas com muitas filiais.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="modelos" class="section">
        <h2>Modelos, Tags e Flags</h2>
        <p>Os relatórios são baseados em <strong>modelos de Google Docs</strong>. Esses modelos contêm marcadores especiais (tags) que serão substituídos pelo pipeline. Na planilha, a aba <em>Modelos</em> armazena os códigos e as descrições de cada modelo disponível.</p>
        <h3>Tags Principais</h3>
        <p>As tags são escritas entre chaves duplas, por exemplo <code>{{empresa}}</code>. Elas são sensíveis ao nome definido no código, portanto evite acentos e espaços. Alguns exemplos:</p>
        <table class="table table-bordered">
            <thead>
                <tr><th>Tag</th><th>Descrição</th><th>Exemplo</th></tr>
            </thead>
            <tbody>
                <tr><td><code>{{empresa}}</code></td><td>Nome da empresa extraído do documento.</td><td>“Transportadora Sul LTDA”</td></tr>
                <tr><td><code>{{mes}}</code> e <code>{{ano}}</code></td><td>Mês e ano do balanço/DRE.</td><td>“junho” e “2025”</td></tr>
                <tr><td><code>{{grupo}}</code></td><td>Nome do grupo selecionado (para relatórios consolidados).</td><td>“Rede de Lojas Norte”</td></tr>
            </tbody>
        </table>
        <p>Além dessas, é possível criar tags personalizadas para campos específicos cadastrados na planilha ou retornar valores de indicadores. Consulte a equipe de TI para ver a lista completa de tags disponíveis.</p>
        <h3>Flags de Consolidação</h3>
        <p>Alguns modelos permitem definir blocos de conteúdo que serão repetidos para cada empresa de um grupo ou, opcionalmente, para um consolidado. Esses blocos são delimitados com um marcador de início <code>&lt;&lt;(flags)&gt;&gt;</code> e um marcador de fim correspondente. As flags controlam o comportamento:</p>
        <ul>
            <li><strong>consolidar</strong> (ou <strong>consolidado</strong>) – inclui o consolidado do grupo após as seções individuais (comportamento padrão).</li>
            <li><strong>semconsolidado</strong>, <strong>semconsolidar</strong> ou <strong>nao-consolidar</strong> – gera apenas as seções individuais, omitindo a parte consolidada.</li>
        </ul>
        <p>Use as flags com cuidado; se tiver dúvida, deixe em branco para utilizar o comportamento padrão (um bloco por empresa, incluindo o consolidado).</p>

        <h3>Blocos de Repetição (&lt;&lt;...&gt;&gt;)</h3>
        <p>Para repetir um trecho do documento para cada empresa de um grupo, utilize um marcador de início <code>&lt;&lt;(flags)&gt;&gt;</code> e um marcador de fim <code>)&gt;&gt;</code>. Tudo entre esses marcadores será copiado para cada integrante. As flags dentro do parênteses são opcionais e devem ser separadas por vírgulas:</p>
        <ul>
            <li><strong>consolidar</strong> ou <strong>consolidado</strong> – inclui uma seção consolidada do grupo além das empresas individuais (caso nenhum flag seja informado este é o padrão).</li>
            <li><strong>semconsolidado</strong>, <strong>semconsolidar</strong> ou <strong>nao-consolidar</strong> – gera apenas as seções individuais, sem adicionar o consolidado.</li>
        </ul>
        <p>Exemplo: <code>&lt;&lt;(consolidar)&gt;&gt; {{empresa}} – análise do período )&gt;&gt;</code> criará uma cópia desse texto para cada empresa do grupo e adicionará uma seção consolidada ao final. Dentro do bloco você pode usar tags como <code>{{empresa}}</code>, <code>{{mes}}</code> e <code>{{ano}}</code> para personalizar cada repetição.</p>

        <h3>Blocos de Tabelas ([[...]] )</h3>
        <p>Os marcadores de tabela permitem preencher automaticamente linhas de uma tabela com dados de balancete ou DRE. Coloque antes da tabela o marcador <code>[[ (p:origem,modo) ]]</code>, onde:</p>
        <ul>
            <li><strong>p:origem</strong> – é obrigatório e indica a origem dos dados: <code>p:balancobase</code> para balancete ou <code>p:drebase</code> para DRE.</li>
            <li><strong>modo</strong> – opcional: <code>resumida</code> (padrão) para usar a versão sintetizada do balancete ou <code>completa</code> para listar todas as contas. Para DRE esse parâmetro é ignorado.</li>
        </ul>
        <p>A tabela no modelo deve ter um cabeçalho na primeira linha e uma linha vazia abaixo, que servirá de modelo. Dentro das células de cabeçalho você pode especificar o campo da planilha entre colchetes, como <code>[conta: Conta]</code> ou <code>[saldoAnterior: Saldo Ant.]</code>. O pipeline replicará a linha vazia para cada registro e preencherá os campos correspondentes.</p>
        <h3>Como Criar/Editar Modelos</h3>
        <ol>
            <li>Abra o Google Docs e crie um novo documento com o layout desejado.</li>
            <li>Insira as tags nos locais onde os dados devem aparecer.</li>
            <li>Salve o documento e copie o ID da URL.</li>
            <li>Na aba <em>Modelos</em> da planilha, inclua uma nova linha com: código (um identificador curto, sem espaços), nome/descrição e o ID do documento.</li>
            <li>Ao gerar o relatório, selecione esse modelo no portal.</li>
        </ol>
    </section>

    <section id="faq" class="section">
        <h2>Dicas &amp; Perguntas Frequentes</h2>
        <h3>Por que o processamento demora?</h3>
        <p>O tempo depende do tamanho e da qualidade dos documentos. PDFs de muitas páginas ou com dados pouco estruturados levam mais tempo. Tenha paciência; você pode acompanhar o progresso no portal.</p>
        <h3>Posso processar vários meses ao mesmo tempo?</h3>
        <p>Sim. Basta colocar todos os documentos na pasta de entrada. O pipeline identificará cada período e empresa automaticamente.</p>
        <h3>Como corrigir dados errados?</h3>
        <p>Após o processamento, consulte as abas <em>BalancoBase</em> e <em>DreBase</em>. Se notar algum valor incorreto, corrija manualmente na planilha antes de gerar o relatório.</p>
        <h3>É possível personalizar os indicadores?</h3>
        <p>Os principais índices já estão programados. Se sua empresa precisa de outros cálculos, entre em contato com a equipe de TI para discutir ajustes. É possível adicionar novas métricas no código.</p>
        <p>Para outras dúvidas, consulte a equipe de suporte ou a documentação técnica.</p>
    </section>

    <footer class="text-center py-4">
        <small>Guia prático do Pipeline de RMAs – atualizado em dezembro de 2025.</small>
    </footer>
</div>

<!-- Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>